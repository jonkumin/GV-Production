"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var fs_1 = require("fs");
var path_1 = require("path");
var constants_1 = require("../constants");
var paths_1 = require("../deploy/paths");
/**
 * Loads the server at {cwd}/server.js.
 * @param serverConfig The server config object from xdn.config.js with optional "export" property.
 */
function loadServer(serverConfig) {
    var config = serverConfig;
    if (!config) {
        config = { path: paths_1.pathForBackend(constants_1.BACKENDS.js) };
    }
    var serverPath = path_1.join(process.cwd(), config.path);
    if (fs_1.existsSync(serverPath)) {
        var server = eval('require')(serverPath);
        if (config.export) {
            server = server[config.export]();
        }
        else if (server.default) {
            server = server.default;
        }
        return server;
    }
    else if (serverConfig) {
        throw new Error("Server not found at " + serverConfig.path + ". Please check the server.path property of xdn.config.js.");
    }
}
exports.default = loadServer;
